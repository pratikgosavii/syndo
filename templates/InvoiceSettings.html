{% extends "partials/adminBase.html" %}
{% load static %}

{% block title %}Add Bank{% endblock title %}

{% block extra_css %}
    <link href="{% static 'libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.css' %}" rel="stylesheet" type="text/css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

<style>
    body {
        background-color: #fefefe;
    }
    .form-container {
        background-color: #ffffff;
        padding: 30px 20px;
        border-radius: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }
    .form-heading {
        font-size: 24px;
        font-weight: 700;
    }
    .form-check-input {
        width: 45px;
        height: 24px;
    }
    .form-check-input:checked {
        background-color: #fbb034;
        border-color: #fbb034;
    }
    .list-group-item {
        border: none;
        padding: 16px 0;
    }
    .invoice-template-img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        border: 1px solid #eee;
        object-fit: contain;
    }
    .invoice-template-col {
        margin-bottom: 1rem;
    }
    .custom-invoice-link:hover {
        background-color: transparent !important;
        color: #212529 !important;
        border-color: #212529 !important;
    }
    .invoice-templates-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    .invoice-templates-row {
        display: flex;
        flex-direction: row;
        gap: 1.5rem;
        flex-wrap: wrap;
    }
    .invoice-templates-row .list-group-item {
        flex: 1;
        min-width: 200px;
    }
</style>

{% endblock extra_css %}

{% block content %}
<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="mb-sm-0 font-size-18"><i class="bi bi-file-earmark-text me-2" style="color: #775599;"></i>Invoice Settings</h4>
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="form-container">
                    
                   <form method="POST">
    {% csrf_token %}

    <div class="d-flex align-items-center mb-4">
        <a href="#" class="btn btn-light me-2 rounded-circle">
            <i class="bi bi-arrow-left"></i>
        </a>
        <h2 class="form-heading m-0 text-dark fw-bold">Invoice Settings</h2>
    </div>

    <div class="list-group mb-4 invoice-templates-list">
        <div class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                <div class="fw-bold">Invoice Templates</div>
                <small class="text-muted">Available invoice templates</small>
            </div>
        </div>
        <div class="invoice-templates-row">
            <div class="list-group-item">
                <p class="small text-muted mb-2">Unregistered - Retail Invoice</p>
                <a href="{% static 'images/Unregistered - Retail Invoice 1.png' %}" target="_blank" class="d-block" style="cursor: pointer;">
                    <img src="{% static 'images/Unregistered - Retail Invoice 1.png' %}" alt="Unregistered - Retail Invoice 1" class="invoice-template-img" style="max-height: 280px;">
                </a>
            </div>
            <div class="list-group-item">
                <p class="small text-muted mb-2">Thermal Bill</p>
                <a href="{% static 'images/Thermal Bill.png' %}" target="_blank" class="d-block" style="cursor: pointer;">
                    <img src="{% static 'images/Thermal Bill.png' %}" alt="Thermal Bill" class="invoice-template-img" style="max-height: 280px;">
                </a>
            </div>
            <div class="list-group-item">
                <p class="small text-muted mb-2">State GST registered - Wholesale Invoice</p>
                <a href="{% static 'images/State GST registered - Wholesale Invoice.png' %}" target="_blank" class="d-block" style="cursor: pointer;">
                    <img src="{% static 'images/State GST registered - Wholesale Invoice.png' %}" alt="State GST registered - Wholesale Invoice" class="invoice-template-img" style="max-height: 280px;">
                </a>
            </div>
            </div>
    </div>

    <div class="mb-4">
        <label class="form-label fw-bold">Terms & Conditions</label>
        <p class="text-muted small mb-2">Add terms and conditions for your invoices (one per vendor). This will appear on your bills.</p>
        {{ invoice_form.terms_and_conditions }}
        {% if invoice_form.terms_and_conditions.errors %}
            <div class="invalid-feedback d-block">{{ invoice_form.terms_and_conditions.errors.0 }}</div>
        {% endif %}
    </div>

    {% for field in invoice_form %}
        {% if field.name != 'terms_and_conditions' %}
        <div class="form-check form-switch d-flex justify-content-between align-items-start mb-3 px-2">
            <div>
                <label class="form-check-label fw-bold" for="{{ field.id_for_label }}">{{ field.label }}</label>
            </div>
            {{ field }}
        </div>
        {% endif %}
    {% endfor %}

    <a href="#" class="btn btn-outline-dark w-100 text-start d-flex justify-content-between align-items-center mt-4 custom-invoice-link">
        <div>
            <div class="fw-bold">Contact support for getting custom invoice</div>
            <small class="text-muted">Get customised invoice templates</small>
        </div>
        <i class="bi bi-chevron-right"></i>
    </a>

    <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary custom-button"><i class="bi bi-check-lg me-1"></i>Submit</button>
    </div>
</form>

                </div>
            </div>

        </div>
    </div>

    {% block footer %}
        {% include 'partials/footer.html' %}
    {% endblock footer %}
</div>
{% endblock content %}

{% block extra_js %}
    <script src="https://cdn.jsdelivr.net/npm/tinymce@6.8.2/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof tinymce !== 'undefined') {
                tinymce.init({
                    selector: '#id_terms_and_conditions',
                    base_url: 'https://cdn.jsdelivr.net/npm/tinymce@6.8.2',
                    suffix: '.min',
                    height: 280,
                    menubar: false,
                    plugins: 'lists link code table',
                    toolbar: 'undo redo | formatselect | bold italic | alignleft aligncenter alignright | bullist numlist | link | removeformat | code',
                    content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'
                });
            }
        });
    </script>
{% endblock extra_js %}
