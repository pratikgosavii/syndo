{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice - {{ wholesale.invoice_number }}</title>
<style>
    body {
        font-family: Arial, sans-serif;
        font-size: 13px;
        color: #000;
        margin: 0;
        padding: 0;
    }
    .invoice-container {
        width: 800px;
        margin: 20px auto;
        border: 1px solid #000;
        padding: 0;
    }
    table {
        border-collapse: collapse;
        width: 100%;
    }
    th, td {
        border: 1px solid #000;
        padding: 6px;
        vertical-align: top;
    }
    .no-border td, .no-border th {
        border: none !important;
        padding: 4px;
    }
    .header {
        text-align: center;
    }
    .company-logo {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: #ccc;
        display: inline-block;
        line-height: 50px;
        text-align: center;
        font-size: 12px;
    }
    .title {
        color: blue;
        font-weight: bold;
    }
    .footer {
        font-size: 12px;
        text-align: center;
        padding: 5px;
    }
    .terms {
        height: 70px;
        vertical-align: top;
    }
    .qr-box {
        text-align: center;
    }
    .summary td {
        text-align: right;
    }
    .bold { font-weight: bold; }
</style>
</head>
<body>

<div class="invoice-container">

    <!-- Title -->
    <table class="no-border">
        <tr>
            <td class="title" colspan="3" style="text-align:center;">INVOICE</td>
        </tr>
    </table>

    <!-- Company Info -->
    <table class="no-border">
        <tr>
            <td style="width: 60px; text-align:center;">
                {% if sale_instance.company_profile and sale_instance.company_profile.profile_image %}
                    <img src="{{ sale_instance.company_profile.profile_image.url }}" width="50" height="50">
                {% else %}
                    <div class="company-logo">Logo</div>
                {% endif %}
            </td>
            <td>
                <div class="bold">{{ sale_instance.company_profile.name }}</div>
                {{ sale_instance.company_profile.address_line1 }}<br>
                {{ sale_instance.company_profile.address_line2 }}
            </td>
            <td style="text-align:right;">
                GSTIN - {{ sale_instance.company_profile.gstin|default:"Unregistered" }}<br>
                <b>Invoice Date:</b> {{ wholesale.date|date:"d/m/Y" }}<br>
                <b>Invoice No.:</b> {{ wholesale.invoice_number }}<br>
                <b>Due Date:</b> {{ wholesale.date|date:"d/m/Y" }}
            </td>
        </tr>
    </table>

    <!-- Customer Info -->
    <table>
        <tr>
            <td><b>Customer Name:</b> {{ sale_instance.customer.name }}</td>
            <td><b>Mobile No:</b> {{ sale_instance.customer.phone }}</td>
        </tr>
    </table>

    <!-- Product Table -->
    <table>
        <thead>
            <tr>
                <th style="width:5%;">S.No.</th>
                <th style="width:45%;">Product / Service</th>
                <th style="width:10%;">MRP</th>
                <th style="width:10%;">Discount</th>
                <th style="width:10%;">Qty</th>
                <th style="width:10%;">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in sale_instance.items.all %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>
                    {{ item.product.name }}<br>
                    size - {{ item.product.size }}, color - {{ item.product.color }},
                    warranty - {{ item.product.warranty }},
                    brand - {{ item.product.brand }},
                    Serial no - {{ item.product.serial_no }}
                </td>
                <td>{{ item.price }}</td>
                <td>{{ item.discount|default:"0" }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.amount|floatformat:2 }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="6">No items found.</td></tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5" class="bold">Total</td>
                <td class="bold">{{ total_amount|floatformat:2 }}</td>
            </tr>
        </tfoot>
    </table>

    <!-- Total Value in Words -->
    <table>
        <tr>
            <td style="width:50%;"><b>Total value in words:</b> {{ total_in_words }}</td>
            <td rowspan="2" style="width:20%; text-align:center;" class="qr-box">
                {% if sale_instance.company_profile.payment_qr %}
                    <img src="{{ sale_instance.company_profile.payment_qr.url }}" width="80" height="80"><br>
                {% else %}
                    <img src="{% static 'qr.png' %}" width="80" height="80"><br>
                {% endif %}
                Pay using UPI
            </td>
            <td rowspan="2" style="width:30%;">
                <table class="summary" style="width:100%;">
                    <tr><td>Discount ({{ sale_instance.discount_percentage }}%)</td></tr>
                    <tr><td>Round off</td></tr>
                    <tr class="bold"><td>Total Amount: â‚¹ {{ total_amount|floatformat:2 }}</td></tr>
                    <tr><td>Paid</td></tr>
                    <tr class="bold"><td style="color:red;">Balance</td></tr>
                </table>
            </td>
        </tr>
        <tr>
            <td class="terms"><b>Terms & Conditions</b><br>{{ wholesale.terms|default:"" }}</td>
        </tr>
    </table>

    <!-- Signature -->
    <table class="no-border">
        <tr>
            <td style="height:50px;"></td>
            <td style="text-align:right;">
                Signature
            </td>
        </tr>
    </table>

</div>

<div class="footer">
    Website - {{ sale_instance.company_profile.website|default:"www.companydomain.com" }}<br>
    Page no. 1
</div>

</body>
</html>
